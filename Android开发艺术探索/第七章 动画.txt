

> Android系统提供了两个动画框架：属性动画框架和View动画框架。 两个动画框架都是可行的选项，但是属性动画框架通常是首选的使用方法，因为它更灵活，并提供更多的功能。 除了这两个框架，还可以使用Drawable动画（即逐帧动画，AnimationDrawable），它允许你加载Drawable资源并逐帧地显示它们。
> 
> 1. View动画框架（补间动画）
> View动画框架中一共提供了AlphaAnimation（透明度动画）、RotateAnimation（旋转动画）、ScaleAnimation（缩放动画）、TranslateAnimation（平移动画）四种类型的补间动画；并且View动画框架还提供了动画集合类（AnimationSet），通过动画集合类（AnimationSet）可以将多个补间动画以组合的形式显示出来。补间动画的实现，一般会采用xml文件的形式，那样代码会更容易书写和阅读，同时也更容易复用。
> 
> 
> 2. 属性动画框架
> 与属性动画相比View动画存在一个缺陷，View动画改变的只是View的显示，而没有改变View的响应区域，并且View动画只能对View做四种类型的补间动画。因此Google在Android3.0（API级别11）及其后续版本中添加了属性动画框架，从名称中就可以知道只要某个类具有属性（即该类含有某个字段的set和get方法），那么属性动画框架就可以对该类的对象进行动画操作（其实就是通过反射技术来获取和执行属性的get，set方法），同样属性动画框架还提供了动画集合类（AnimatorSet），通过动画集合类（AnimatorSet）可以将多个属性动画以组合的形式显示出来。
> 
> 
> 作者：ForeverCy
> 链接：http://www.jianshu.com/p/b117c974deaf
> 碓矗杭蚴
> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。






###一、View动画

View动画的四种变换效果对应着Animation的四个子类：TranslateAnimation、ScaleAnimation、RotateAnimation、AlphaAnimation。四种动画可以用这四个类通过代码实现，也可以使用XML文件来定义。建议使用XML来定义动画，因为XML格式可读性好而且方便复用。

名称       |标签         |子类
-----------|-------------|------------------
平移动画   |<translate/> |TranslateAnimation
缩放动画   |<scale/>     |ScaleAnimation
选中动画   |<rotate/>    |RotateAnimation
透明度动画 |<alpha/>     |AlphaAnimation


```
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator=""
    android:shareInterpolator="true|false">
	<translate
        android:fromXDelta=""
        android:toXDelta=""
        android:fromYDelta=""
        android:toYDelta="" />
	<scale
        android:fromXScale=""
        android:toXScale=""
        android:fromYScale=""
        android:toYScale=""
        android:pivotX=""
        android:pivotY="" />
    <rotate
        android:fromDegrees=""
        android:toDegrees=""
        android:pivotX=""
        android:pivotY="" />
    <alpha
        android:fromAlpha=""
        android:toAlpha="" />
    
    <set>
        <!--set嵌套set-->
    </set>
</set>
```
View动画可以是单个动画，也可以由一系列动画组成，使用<set>标签实现组合。<set>标签对应AnimationSet类，内部也可以嵌套其他动画集合。

**android:interpolator**表示动画集合所使用的插值器，插值器影响动画的速度，比如非匀速动画就需要通过插值器来控制动画的播放过程。这个属性可以不指定，默认是@android:anim/accelerate_decelerate_interpolator，即加速减速插值器。
**android:shareInterpolator**表示集合中的动画是否和集合共享同一个插值器。如果集合不指定插值器，那么子动画就需要单独指定所需要的插值器或者使用默认值。

######<translate>
android:fromXDelta  x的起始值
android:toXDelta  x的结束值
android:fromYDelta  y的起始值
android:toYDelta  y的结束值

######<scale>
android:fromXScale  水平方向缩放的起始值
android:toXScale  水平方向缩放的结束值
android:fromYScale  竖直方向缩放的起始值
android:toYScale  竖直方向缩放的结束值
android:pivotX  缩放的轴点的x坐标
android:pivotY   缩放的轴点的y坐标

######<rotate>
android:fromDegrees  旋转开始的角度
android:toDegrees  旋转结束的角度
android:pivotX  旋转的轴点的x坐标
android:pivotY  选中的轴点的y坐标

######<alpha>
android:fromAlpha  透明度的起始值
android:toAlpha  透明度的结束值

######一些其他常用属性
android:duration  动画的持续时间
android:fillBefore  动画结束后是否回到执行前的位置
android:fillAfter  动画结束后是否停留在结束位置
android:interpolator  动画使用的插值器
android:startOffset  动画执行之前的等待时间
android:repeatCount  动画重复执行的次数
_xml属性都有对应的set方法_



####使用示例
首先编写动画xml文件test_anim.xml
```
Button mButton = (Button)findViewById(R.id.button);
Animation animation = AnimationUtils.loadAnimation(context, R.anim.test_anim);
mButton.startAnimation(animation);
```
也可以通过代码实现
```
AlphaAnimation animation = new AlphaAnimation(0, 1);
animation.setDuration(300);
mButton.startAnimation(animation);
```
使用setAnimationListener方法可以给动画添加过程监听。


####View动画的特殊使用场景

######LayoutAnimation控制ViewGroup的子View的出场效果，使用步骤如下：
1. 定义LayoutAnimation，文件名res/anim/anim_layout.xml
```
<layoutAnimation xmlns:android="http://schemas.android.com/apk/res/android" 
    android:delay="150"
    android:animationOrder="normal"
    android:animation="@anim/anim_item"/>
```
android:delay 子元素开始动画的时间延迟
android:animationOrder 子元素动画的顺序。有normal（顺序）、reverse（逆向）、random（随机）三种顺序。
android:animation  子元素入场的具体动画

2. 定义子元素具体的入场动画，文件名res/anim/anim_item.xml
```
<translate xmlns:android="http://schemas.android.com/apk/res/android"
    android:fromXDelta="500"
    android:toXDelta="0"/>
```

3. 为Viewgroup指定 android:layoutAnimation属性，比如ListView：
```
<ListView
    android:id="@+id/list"
	android:layout_width="match_parent"
	android:layout_height="match_parent"
	android:layoutAnimation="@anim/anim_layout" />
```
除了通过xml中指定layoutAnimation属性，也可以通过LayoutAnimationController来实现：
```
Animation animation = AnimationUtils.loadAnimation(context, R.anim.anim_item);
LayoutAnimationController controller = new LayoutAnimationController(animation);
controller.setDelay(0.5f);
controller.setOrder(LayoutAnimationController.ORDER_NORMAL);
listView.setLayoutAnimation(controller);
```


######Activity的切换效果
使用overridePendingTransition(int enterAnim, int exitAnim)方法实现Activity的切换动画，这个方法必须在startActivity()或者finish()之后调用才能生效。
Fragment也可以添加切换动画，通过FragmentTransaction中的setCustomAnimations()方法实现。





###二、帧动画
帧动画的标签是<animation-list>，对应AnimationDrawable类。
示例代码
```
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" 
    android:oneshot="false">
    <item android:drawable="@drawable/img1" android:duration="500"/>
    <item android:drawable="@drawable/img2" android:duration="500"/>
    <item android:drawable="@drawable/img3" android:duration="500"/>
</animation-list>
```
```
Button mButton = (Button)findViewById(R.id.button1);
mButton.setBackgroundResource(R.drawable.frame_animation);
AnimationDrawable drawable = (AnimationDrawable)mButton.getBackground();
drawable.start();
```
注意帧动画容易引起OOM。






###三、属性动画

属性动画从 API 11 才有，属性动画可以对任意对象的属性进行动画而不仅仅是View，达到的效果是：在一个时间间隔内完成对象从一个属性值到另一个属性值的改变。属性动画常用的动画类：ValueAnimator、ObjectAnimator、AnimatorSet。ObjectAnimator继承自ValueAnimator，AnimatorSet是动画集合。
属性动画也有对应的xml标签，但是建议使用代码来实现属性动画，因为使用代码比xml简单。而且很多时候一个属性的起始值无法提前确定。

####一、通过几个例子看如何使用属性动画：

1. 改变对象myObject的translationY属性，让其沿着Y轴向上平移一段距离：它的高度。该动画在默认时间内完成
```
ObjectAnimator.ofFloat(myObject, "translationY", -myObject.getHeight()).start();
```

2. 改变一个对象的背景色属性，让背景色在3秒内从 0xFFFF8080 到 0xFF8080FF 的渐变，动画会无限循环而且会有反转效果
```
ValueAnimator anim = ObjectAnimator.ofInt(myObject, "backgroundColor",0xFFFF8080,0xFF8080FF);
anim.setDuration(3000);
anim.setEvaluator(new ArgbEvaluator());
anim.setRepeatCount(ValueAnimator.INFINITE);
anim.setRepeatMode(ValueAnimator.REVERSE);
anim.start();
```

3. 动画集合，5秒内对View的旋转，平移，缩放和透明都进行改变。
```
AnimatorSet set = new AnimatorSet();
set.playTogether(
        ObjectAnimator.ofFloat(myView, "rotationX", 0, 360),
        ObjectAnimator.ofFloat(myView, "rotationY", 0, 180),
        ObjectAnimator.ofFloat(myView, "rotation", 0, -90),
        ObjectAnimator.ofFloat(myView, "translationX", 0, 90),
        ObjectAnimator.ofFloat(myView, "translationY", 0, 90),
        ObjectAnimator.ofFloat(myView, "scaleX", 1, 1.5f),
        ObjectAnimator.ofFloat(myView, "scaleY", 1, 0.5f),
        ObjectAnimator.ofFloat(myView, "alpha", 1, 0.25f, 1)
);
set.setDuration(5*1000).start();
```

####二、上面的代码总结
上面代码用到一个主要的方法
ObjectAnimator.ofFloat(target, propertyName, values...);

target   是动画目标，任何对象，不一定必须是View
propertyName 是属性名字
values   是可变参数， 从v1变化到v2到vn。。。

例子：
mIv是一个imageView
//alpha 从0 到1 的动画
ObjectAnimator.ofFloat(mIv, "alpha", 0f,1f)
.setDuration(500)
.start();
如果要实现其他效果，修改propertyName和values就行了。


######在属性动画中，View的常用属性
alpha          透明度
rotation       z轴旋转
rotationX      x轴旋转
rotationY      y轴旋转
translationX   x水平偏移
translationY   y水平偏移
ScaleX         x轴缩放
ScaleY         y轴缩放


####三、插值器和估值器


Interpolator 被用来修饰动画效果，定义动画的变化率，可以使存在的动画效果accelerated(加速)，decelerated(减速),repeated(重复),bounced(弹跳)等。
AccelerateDecelerateInterpolator 在动画开始与结束的地方速率改变比较慢，在中间的时候加速
AccelerateInterpolator  在动画开始的地方速率改变比较慢，然后开始加速
AnticipateInterpolator 开始的时候向后然后向前甩
AnticipateOvershootInterpolator 开始的时候向后然后向前甩一定值后返回最后的值
BounceInterpolator   动画结束的时候弹起
CycleInterpolator 动画循环播放特定的次数，速率改变沿着正弦曲线
DecelerateInterpolator 在动画开始的地方快然后慢
LinearInterpolator   以常量速率改变
OvershootInterpolator    向前甩一定值后再回到原来位置

如果android定义的interpolators不符合你的效果也可以自定义interpolators












































